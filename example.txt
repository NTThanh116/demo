Sub Split_By_SetID_Strict()

    Dim wsData As Worksheet
    Dim wsOut As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim r As Long
    Dim setID As Integer
    
    ' Chỉ định đúng sheet data
    Set wsData = ThisWorkbook.Sheets("ALL_RESULTS")
    
    lastRow = wsData.Cells(wsData.Rows.Count, "A").End(xlUp).Row
    
    ' ===== Loop theo SetID 1 → 3 =====
    For setID = 1 To 3
        
        On Error Resume Next
        Application.DisplayAlerts = False
        Sheets("SUMMARY_SET_" & setID).Delete
        Application.DisplayAlerts = True
        On Error GoTo 0
        
        Set wsOut = Sheets.Add
        wsOut.Name = "SUMMARY_SET_" & setID
        
        ' Copy header
        wsOut.Range("A1:W1").Value = wsData.Range("A1:W1").Value
        
        r = 2
        
        For i = 2 To lastRow
            
            ' Filter đúng CỘT D
            If wsData.Cells(i, 4).Value = setID Then
                
                wsOut.Range("A" & r & ":W" & r).Value = _
                    wsData.Range("A" & i & ":W" & i).Value
                
                r = r + 1
                
            End If
            
        Next i
        
        wsOut.Columns.AutoFit
        
    Next setID
    
    MsgBox "Split by SetID completed correctly!", vbInformation

End Sub
